
<script language="Javascript">
  /*
   * This is a sample JavaScript HTTP REST client generated by HTTP4e (http://www.nextinterfaces.com).
   */
  var url = "$httpBean.url";
  var method = "$httpBean.method";
  var params = "$httpBean.paramsForUrl";
  var data = "$httpBean.body";

  var setRequestHeaders = function(xhr) {
#foreach( $hKey in $httpBean.headers.keySet() )
      xhr.setRequestHeader("$hKey", "$httpBean.headers.get($hKey)");
#end
  }
  
  var request = function(method, url, body, successHandler, errorHandler) {
      var xhr = null;
      if (window.XMLHttpRequest) {
          xhr = new XMLHttpRequest();
      }
      if (window.ActiveXObject) {
          xhr = new ActiveXObject("Microsoft.XMLHTTP");
      }
      xhr.onreadystatechange = function stateChange() {
          if (xhr.readyState == 4) {
              if (xhr.status == 200 || xhr.status == 201) { if(successHandler) successHandler(xhr); }
              else { if(errorHandler) errorHandler(xhr); }
          }
      };
      xhr.open(method.toUpperCase(), url, true);
      // setRequestHeader() must be called AFTER open() !!
      setRequestHeaders(xhr);
      xhr.send(body);
  };

  var onSuccess = function(xhr) {
      debug(xhr);
  }
  
  var onError = function() {
      debug(xhr);
  }
  
  var debug = function(xhr) {		
      if (xhr.readyState == 4) {
      alert("HTTP/1.1 " + xhr.status + " " + xhr.statusText + 
            "\n" + xhr.getAllResponseHeaders() + 
            "\n" + xhr.responseText);	
	}
  }
  
  /*
   * Finally execute the HTTP call
   */
  request(method, url, data, onSuccess, onError);

</script>